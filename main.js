!function(){"use strict";class e{constructor(e,t,s,i,n){this._id=e._id,this._name=e.name,this._link=e.link,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleRemoveCard=i,this._api=n,this._getViews()}_getViews(){this._cardElement=document.getElementById(this._cardSelector).content.cloneNode(!0),this._likeButton=this._cardElement.querySelector(".card__like-btn"),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._trashButton=this._cardElement.querySelector(".card_trash-button"),this._likeButton=this._cardElement.querySelector(".card__like-btn"),this._isLiked&&this._toggleLike()}_toggleLike(){this._likeButton.classList.toggle("card__like-btn-active")}getCardElement(){return this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardTitle.textContent=this._name,this._setEventListeners(),this._cardElement}_setEventListeners(){this._trashButton.addEventListener("click",(e=>{const t=e.target.closest(".card");this._handleRemoveCard(t,this._id)})),this._likeButton.addEventListener("click",(()=>{this._api.like(this._isLiked,this._id).then((e=>{this._isLiked=!this._isLiked,this._toggleLike()})).catch((e=>{console.log(e)}))})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)}))}}const t={formSelector:".model__form",inputSelector:".model__form-input",submitButtonSelector:".model__submit-button",inactiveButtonClass:"model__submit-button-inactive",inputErrorClass:"-input-error",errorClass:"model__input-error-active"},s=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button"),n=document.querySelectorAll(".model__form"),r=document.querySelector(".profile__avatar");class o{constructor(e){let{selector:t}=e;this._popupElement=document.querySelector(t),this._closeButtons=this._popupElement.querySelector(".model__close-button")}open(){this._popupElement.classList.add("model_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("model_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"==e.key&&this.close()};setEveentListeners(){this._closeButtons.addEventListener("click",(e=>{this.close()})),this._popupElement.addEventListener("mousedown",(e=>{e.currentTarget===e.target&&this.close()}))}}class a extends o{constructor(e,t,s){super({selector:e}),this._popupForm=this._popupElement.querySelector(".model__form"),this._inputList=Array.from(this._popupForm.querySelectorAll("input")),this._handleFormSubmit=t,this._validator=s,this._submitButton=this._popupForm.querySelector(".model__submit-button")}close(){super.close()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEveentListeners(){super.setEveentListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._submitButton.textContent="Save...",this._handleFormSubmit(this._getInputValues())}))}submissionCompleate(){this._submitButton.textContent="Save",this._popupForm.reset(),this._validator.toggleButtonState(),this.close()}}class l{constructor(e,t){this._options=e,this._formElement=t,this._getViews()}_getViews(){this._inputList=Array.from(this._formElement.querySelectorAll(this._options.inputSelector)),this._buttonElement=this._formElement.querySelector(this._options.submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.name}${this._options.inputErrorClass}`);s.textContent=t,s.classList.add(this._options.errorClass)}forceHideInputError(){this._inputList.forEach((e=>{this._hideInputError(e)}))}_hideInputError(e){const t=this._formElement.querySelector(`.${e.name}${this._options.inputErrorClass}`);t.classList.remove(this._options.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}toggleButtonState(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._hasInvalidInput()&&!e?(this._buttonElement.classList.add(this._options.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._options.inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._setEventListeners()}}const c={},h=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_getRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET";return fetch(this._baseUrl+e,{method:t,headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}_requestWithBody(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return fetch(this._baseUrl+e,{method:s,headers:this._headers,body:JSON.stringify(t)}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserData(){return this._getRequest("/users/me")}editProfile(e){return this._requestWithBody("/users/me",e,"PATCH")}editAvatar(e){return this._requestWithBody("/users/me/avatar",e,"PATCH")}getInitialCards(){return this._getRequest("/cards")}addCard(e){return this._requestWithBody("/cards",e)}like(e,t){const s=e?"DELETE":"PUT";return this._getRequest(`/cards/${t}/likes`,s)}removeCard(e){return this._getRequest(`/cards/${e}`,"DELETE")}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a1435ffd-8061-442b-b2ae-d3458326825a","Content-Type":"application/json"}}),u=new class{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._elementsContainer=document.querySelector(t)}setItems(e){this._items=e}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this._elementsContainer.prepend(e):this._elementsContainer.appendChild(e)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{u.addItem(L(e))}},".galery__cards");n.forEach((e=>{c[e.id]=new l(t,e),c[e.id].enableValidation()}));const d=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._nameLabel=document.querySelector(t),this._jobLabel=document.querySelector(s),this._avatarSRC=document.querySelector(i)}getUserInfo(){return{name:this._nameLabel.textContent,job:this._jobLabel.textContent,img:this._avatarSRC.src}}setUserInfo(e,t){this._nameLabel.textContent=e,this._jobLabel.textContent=t}setAvatarLink(e){this._avatarSRC.src=e}}({nameSelector:".profile__title",jobSelector:".profile__subtitle",avatarSelector:".profile__image"}),_=new a("#modal-profile",(e=>{h.editProfile({name:e.name,about:e.job}).then((e=>{d.setUserInfo(e.name,e.about)})).catch((e=>{console.log(e)})).finally((()=>{_.submissionCompleate()}))}),c.profile),m=new a("#modal-cards",(e=>{h.addCard({name:e.title,link:e.link}).then((e=>{u.addItem(L(e),!0)})).catch((e=>{console.log(e)})).finally((()=>{m.submissionCompleate()}))}),c.cards),p=new a("#modal-edit-avatar",(e=>{h.editAvatar({avatar:e.avatar}).then((e=>{d.setAvatarLink(e.avatar)})).catch((e=>{console.log(e)})).finally((()=>{p.submissionCompleate()}))}),c.avatar),g=new class extends o{constructor(e){super({selector:e}),this._image=this._popupElement.querySelector(".model__image"),this._imageLabel=this._popupElement.querySelector(".model__image-label")}open(e){this._image.src=e.link,this._image.alt=e.name,this._imageLabel.textContent=e.name,super.open()}}("#modal-image"),E=new class extends o{constructor(e,t){super({selector:e}),this._button=this._popupElement.querySelector(".model__submit-button"),this._handleFormSubmit=t}open(e,t){super.open(),this._card=e,this._id=t}setEveentListeners(){super.setEveentListeners(),this._button.addEventListener("click",(e=>{e.preventDefault(),this._handleFormSubmit(this._card,this._id),this.close()}))}}("#modal-sure",((e,t)=>{h.removeCard(t).then((t=>{e.remove()})).catch((e=>{console.log(e)})).finally((()=>{E.close()}))}));s.addEventListener("click",(()=>{_.setInputValues(d.getUserInfo()),_.open()})),i.addEventListener("click",(()=>{m.open()})),r.addEventListener("click",(()=>{p.open()}));const v=(e,t)=>{g.open({name:e,link:t})},b=(e,t)=>{E.open(e,t)},L=t=>new e(t,"card-template",v,b,h).getCardElement();_.setEveentListeners(),m.setEveentListeners(),g.setEveentListeners(),p.setEveentListeners(),E.setEveentListeners(),h.getInitialCards().then((e=>{u.setItems(e),u.renderItems()})).catch((e=>{console.log(e)})),h.getUserData().then((e=>{d.setUserInfo(e.name,e.about),d.setAvatarLink(e.avatar)})).catch((e=>{console.log(e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxFQUd4QkYsRUFBYy9KLEdBQ2xCLElBQUlGLEVBQ0ZFLEVBQ0EsZ0JBQ0FFLEVBQ0E0TCxFQUNBMUwsR0FDQTJCLGlCQUVKK0ksRUFBYXJHLHFCQUNiMEcsRUFBVzFHLHFCQUNYK0csRUFBVy9HLHFCQUNYNkcsRUFBYzdHLHFCQUNka0gsRUFBY2xILHFCQUVkckUsRUFDR3lJLGtCQUNBbkcsTUFBTXFKLElBQ0w1QyxFQUFlTSxTQUFTc0MsR0FDeEI1QyxFQUFlTyxhQUFhLElBRTdCOUcsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxJQUdwQnpDLEVBQ0dzSSxjQUNBaEcsTUFBTTJJLElBQ0xuQixFQUFTVSxZQUFZUyxFQUFTN0ssS0FBTTZLLEVBQVNMLE9BQzdDZCxFQUFTVyxjQUFjUSxFQUFTRSxPQUFPLElBRXhDM0ksT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBTaW1wbGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZVJlbW92ZUNhcmQsIGFwaSkge1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2lzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZVJlbW92ZUNhcmQgPSBoYW5kbGVSZW1vdmVDYXJkO1xuICAgIHRoaXMuX2FwaSA9IGFwaTtcbiAgICB0aGlzLl9nZXRWaWV3cygpO1xuICB9XG5cbiAgX2dldFZpZXdzKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5nZXRFbGVtZW50QnlJZCh0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG5cbiAgICB0aGlzLl90cmFzaEJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF90cmFzaC1idXR0b25cIik7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG5cbiAgICBpZiAodGhpcy5faXNMaWtlZCkgdGhpcy5fdG9nZ2xlTGlrZSgpO1xuICB9XG5cbiAgX3RvZ2dsZUxpa2UoKSB7XG4gICAgY29uc3QgY3VycmVudENsYXNzTGlzdCA9IHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0O1xuICAgIGN1cnJlbnRDbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG4tYWN0aXZlXCIpO1xuICB9XG5cbiAgZ2V0Q2FyZEVsZW1lbnQoKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KFwiLmNhcmRcIik7XG4gICAgICB0aGlzLl9oYW5kbGVSZW1vdmVDYXJkKGNhcmQsIHRoaXMuX2lkKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2FwaVxuICAgICAgICAubGlrZSh0aGlzLl9pc0xpa2VkLCB0aGlzLl9pZClcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgIHRoaXMuX2lzTGlrZWQgPSAhdGhpcy5faXNMaWtlZDtcbiAgICAgICAgICB0aGlzLl90b2dnbGVMaWtlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBhcGlPcHRpb25zID0ge1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImExNDM1ZmZkLTgwNjEtNDQyYi1iMmFlLWQzNDU4MzI2ODI1YVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufTtcblxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3Qgb3B0aW9uc1ZhbGlkYXRpb24gPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kZWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kZWxfX2Zvcm0taW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGVsX19zdWJtaXQtYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kZWxfX3N1Ym1pdC1idXR0b24taW5hY3RpdmVcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIi1pbnB1dC1lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGVsX19pbnB1dC1lcnJvci1hY3RpdmVcIixcbn07XG5cbmV4cG9ydCBjb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgbW9kYWxzRm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGVsX19mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGVkaXRBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBzZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCdXR0b25zID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RlbF9fY2xvc2UtYnV0dG9uXCJcbiAgICApO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGVsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGVsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2xvc2VCdXR0b25zLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC5jdXJyZW50VGFyZ2V0ID09PSBldnQudGFyZ2V0KSB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvcihzZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCwgdmFsaWRhdG9yKSB7XG4gICAgc3VwZXIoeyBzZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RlbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRcIikpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX3ZhbGlkYXRvciA9IHZhbGlkYXRvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RlbF9fc3VibWl0LWJ1dHRvblwiKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBmb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0RXZlZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZWVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlLi4uXCI7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG5cbiAgc3VibWlzc2lvbkNvbXBsZWF0ZSgpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgICB0aGlzLl92YWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLmNsb3NlKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2dldFZpZXdzKCk7XG4gIH1cblxuICBfZ2V0Vmlld3MoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fb3B0aW9ucy5pbnB1dFNlbGVjdG9yKVxuICAgICk7XG5cbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX29wdGlvbnMuc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQubmFtZX0ke3RoaXMuX29wdGlvbnMuaW5wdXRFcnJvckNsYXNzfWBcbiAgICApO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9vcHRpb25zLmVycm9yQ2xhc3MpO1xuICB9XG5cbiAgZm9yY2VIaWRlSW5wdXRFcnJvcigpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLiR7aW5wdXRFbGVtZW50Lm5hbWV9JHt0aGlzLl9vcHRpb25zLmlucHV0RXJyb3JDbGFzc31gXG4gICAgKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9vcHRpb25zLmVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoZm9yY2VEaXNhYmxlID0gZmFsc2UpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkgJiYgIWZvcmNlRGlzYWJsZSkge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX29wdGlvbnMuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX29wdGlvbnMuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChldmVudCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQge1xuICBpbml0aWFsQ2FyZHMsXG4gIGVkaXRCdXR0b24sXG4gIGFkZEJ1dHRvbixcbiAgb3B0aW9uc1ZhbGlkYXRpb24sXG4gIG1vZGFsc0Zvcm1zLFxuICBlZGl0QXZhdGFyQnV0dG9uLFxuICBhcGlPcHRpb25zLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFNpbXBsZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFNpbXBsZS5qc1wiO1xuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5cbmNvbnN0IGZvcm12YWxpZGF0b3JMaXN0ID0ge307XG5jb25zdCBhcGkgPSBuZXcgQXBpKGFwaU9wdGlvbnMpO1xuY29uc3QgZ2FsbGVyeVNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICBnYWxsZXJ5U2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQoZGF0YSkpO1xuICAgIH0sXG4gIH0sXG4gIFwiLmdhbGVyeV9fY2FyZHNcIlxuKTtcblxubW9kYWxzRm9ybXMuZm9yRWFjaCgoZm9ybSkgPT4ge1xuICBmb3JtdmFsaWRhdG9yTGlzdFtmb3JtLmlkXSA9IG5ldyBGb3JtVmFsaWRhdG9yKG9wdGlvbnNWYWxpZGF0aW9uLCBmb3JtKTtcbiAgZm9ybXZhbGlkYXRvckxpc3RbZm9ybS5pZF0uZW5hYmxlVmFsaWRhdGlvbigpO1xufSk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fc3VidGl0bGVcIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuY29uc3QgcHJvZmlsZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI21vZGFsLXByb2ZpbGVcIixcbiAgKGZvcm1EYXRhKSA9PiB7XG4gICAgYXBpXG4gICAgICAuZWRpdFByb2ZpbGUoeyBuYW1lOiBmb3JtRGF0YS5uYW1lLCBhYm91dDogZm9ybURhdGEuam9iIH0pXG4gICAgICAudGhlbigocmVzcG9uY2UpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzcG9uY2UubmFtZSwgcmVzcG9uY2UuYWJvdXQpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBwcm9maWxlTW9kYWwuc3VibWlzc2lvbkNvbXBsZWF0ZSgpO1xuICAgICAgfSk7XG4gIH0sXG4gIGZvcm12YWxpZGF0b3JMaXN0W1wicHJvZmlsZVwiXVxuKTtcblxuY29uc3QgY2FyZHNNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNtb2RhbC1jYXJkc1wiLFxuICAoZm9ybURhdGEpID0+IHtcbiAgICBhcGlcbiAgICAgIC5hZGRDYXJkKHsgbmFtZTogZm9ybURhdGEudGl0bGUsIGxpbms6IGZvcm1EYXRhLmxpbmsgfSlcbiAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICBnYWxsZXJ5U2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQocmVzcG9uc2UpLCB0cnVlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgY2FyZHNNb2RhbC5zdWJtaXNzaW9uQ29tcGxlYXRlKCk7XG4gICAgICB9KTtcbiAgfSxcbiAgZm9ybXZhbGlkYXRvckxpc3RbXCJjYXJkc1wiXVxuKTtcblxuY29uc3QgYXZhckVkaXRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNtb2RhbC1lZGl0LWF2YXRhclwiLFxuICAoZm9ybURhdGEpID0+IHtcbiAgICBhcGlcbiAgICAgIC5lZGl0QXZhdGFyKHsgYXZhdGFyOiBmb3JtRGF0YS5hdmF0YXIgfSlcbiAgICAgIC50aGVuKChyZXNwb25jZSkgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRBdmF0YXJMaW5rKHJlc3BvbmNlLmF2YXRhcik7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGF2YXJFZGl0TW9kYWwuc3VibWlzc2lvbkNvbXBsZWF0ZSgpO1xuICAgICAgfSk7XG4gIH0sXG4gIGZvcm12YWxpZGF0b3JMaXN0W1wiYXZhdGFyXCJdXG4pO1xuXG5jb25zdCBpbWFnZU1vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI21vZGFsLWltYWdlXCIpO1xuY29uc3QgcHJlRGVsZXRlcG91cCA9IG5ldyBQb3B1cFNpbXBsZShcIiNtb2RhbC1zdXJlXCIsIChjYXJkLCBpZCkgPT4ge1xuICBhcGlcbiAgICAucmVtb3ZlQ2FyZChpZClcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBjYXJkLnJlbW92ZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwcmVEZWxldGVwb3VwLmNsb3NlKCk7XG4gICAgfSk7XG59KTtcblxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwcm9maWxlTW9kYWwuc2V0SW5wdXRWYWx1ZXModXNlckluZm8uZ2V0VXNlckluZm8oKSk7XG4gIHByb2ZpbGVNb2RhbC5vcGVuKCk7XG59KTtcbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjYXJkc01vZGFsLm9wZW4oKTtcbn0pO1xuXG5lZGl0QXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXJFZGl0TW9kYWwub3BlbigpO1xufSk7XG5cbmNvbnN0IGhhbmRsZUltYWdlQ2xpY2sgPSAobmFtZSwgbGluaykgPT4ge1xuICBpbWFnZU1vZGFsLm9wZW4oeyBuYW1lOiBuYW1lLCBsaW5rOiBsaW5rIH0pO1xufTtcbmNvbnN0IGhhbmRsZXJSZW1vdmVDYXJkID0gKGNhcmQsIGlkKSA9PiB7XG4gIHByZURlbGV0ZXBvdXAub3BlbihjYXJkLCBpZCk7XG59O1xuXG5jb25zdCBjcmVhdGVDYXJkID0gKGRhdGEpID0+XG4gIG5ldyBDYXJkKFxuICAgIGRhdGEsXG4gICAgXCJjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVyUmVtb3ZlQ2FyZCxcbiAgICBhcGlcbiAgKS5nZXRDYXJkRWxlbWVudCgpO1xuXG5wcm9maWxlTW9kYWwuc2V0RXZlZW50TGlzdGVuZXJzKCk7XG5jYXJkc01vZGFsLnNldEV2ZWVudExpc3RlbmVycygpO1xuaW1hZ2VNb2RhbC5zZXRFdmVlbnRMaXN0ZW5lcnMoKTtcbmF2YXJFZGl0TW9kYWwuc2V0RXZlZW50TGlzdGVuZXJzKCk7XG5wcmVEZWxldGVwb3VwLnNldEV2ZWVudExpc3RlbmVycygpO1xuXG5hcGlcbiAgLmdldEluaXRpYWxDYXJkcygpXG4gIC50aGVuKChpbml0aWFsQ2FyZHMpID0+IHtcbiAgICBnYWxsZXJ5U2VjdGlvbi5zZXRJdGVtcyhpbml0aWFsQ2FyZHMpO1xuICAgIGdhbGxlcnlTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG5cbmFwaVxuICAuZ2V0VXNlckRhdGEoKVxuICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXNwb25zZS5uYW1lLCByZXNwb25zZS5hYm91dCk7XG4gICAgdXNlckluZm8uc2V0QXZhdGFyTGluayhyZXNwb25zZS5hdmF0YXIpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgfVxuXG4gIF9nZXRSZXF1ZXN0KGVuZFBvaW50LCBtZXRob2QgPSBcIkdFVFwiKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBlbmRQb2ludCwge1xuICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIF9yZXF1ZXN0V2l0aEJvZHkoZW5kUG9pbnQsIGJvZHksIG1ldGhvZCA9IFwiUE9TVFwiKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBlbmRQb2ludCwge1xuICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0VXNlckRhdGEoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2dldFJlcXVlc3QoXCIvdXNlcnMvbWVcIik7XG4gIH1cblxuICBlZGl0UHJvZmlsZShib2R5KSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3RXaXRoQm9keShcIi91c2Vycy9tZVwiLCBib2R5LCBcIlBBVENIXCIpO1xuICB9XG5cbiAgZWRpdEF2YXRhcihib2R5KSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3RXaXRoQm9keShcIi91c2Vycy9tZS9hdmF0YXJcIiwgYm9keSwgXCJQQVRDSFwiKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fZ2V0UmVxdWVzdChcIi9jYXJkc1wiKTtcbiAgfVxuXG4gIGFkZENhcmQoYm9keSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0V2l0aEJvZHkoXCIvY2FyZHNcIiwgYm9keSk7XG4gIH1cblxuICBsaWtlKGlzTGlrZSwgY2FyZElkKSB7XG4gICAgY29uc3QgbWV0aG9kID0gaXNMaWtlID8gXCJERUxFVEVcIiA6IFwiUFVUXCI7XG4gICAgcmV0dXJuIHRoaXMuX2dldFJlcXVlc3QoYC9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCBtZXRob2QpO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fZ2V0UmVxdWVzdChgL2NhcmRzLyR7Y2FyZElkfWAsIFwiREVMRVRFXCIpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fZWxlbWVudHNDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgfVxuXG4gIHNldEl0ZW1zKGl0ZW1zKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShpdGVtLCBpc1B1dE9uRmlyc3RQbGFzZSA9IGZhbHNlKSB7XG4gICAgaWYgKGlzUHV0T25GaXJzdFBsYXNlKSB0aGlzLl9lbGVtZW50c0NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xuICAgIGVsc2UgdGhpcy5fZWxlbWVudHNDb250YWluZXIuYXBwZW5kQ2hpbGQoaXRlbSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUxhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2pvYkxhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyU1JDID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVMYWJlbC50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fam9iTGFiZWwudGV4dENvbnRlbnQsXG4gICAgICBpbWc6IHRoaXMuX2F2YXRhclNSQy5zcmMsXG4gICAgfTtcbiAgfVxuICBzZXRVc2VySW5mbyhuYW1lLCBqb2IpIHtcbiAgICB0aGlzLl9uYW1lTGFiZWwudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2pvYkxhYmVsLnRleHRDb250ZW50ID0gam9iO1xuICB9XG5cbiAgc2V0QXZhdGFyTGluayhsaW5rKSB7XG4gICAgdGhpcy5fYXZhdGFyU1JDLnNyYyA9IGxpbms7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kZWxfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2ltYWdlTGFiZWwgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RlbF9faW1hZ2UtbGFiZWxcIik7XG4gIH1cblxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuXG4gICAgdGhpcy5faW1hZ2VMYWJlbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFNpbXBsZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGVsX19zdWJtaXQtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICB9XG5cbiAgb3BlbihjYXJkLCBpZCkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9jYXJkID0gY2FyZDtcbiAgICB0aGlzLl9pZCA9IGlkO1xuICB9XG5cbiAgc2V0RXZlZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZWVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fY2FyZCwgdGhpcy5faWQpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVSZW1vdmVDYXJkIiwiYXBpIiwidGhpcyIsIl9pZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVSZW1vdmVDYXJkIiwiX2FwaSIsIl9nZXRWaWV3cyIsIl9jYXJkRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2xpa2VCdXR0b24iLCJxdWVyeVNlbGVjdG9yIiwiX2NhcmRJbWFnZSIsIl9jYXJkVGl0bGUiLCJfdHJhc2hCdXR0b24iLCJfdG9nZ2xlTGlrZSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImdldENhcmRFbGVtZW50Iiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJjYXJkIiwidGFyZ2V0IiwiY2xvc2VzdCIsImxpa2UiLCJ0aGVuIiwicmVzIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwib3B0aW9uc1ZhbGlkYXRpb24iLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJtb2RhbHNGb3JtcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlZGl0QXZhdGFyQnV0dG9uIiwiUG9wdXAiLCJfcmVmIiwic2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnV0dG9ucyIsIm9wZW4iLCJhZGQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVlbnRMaXN0ZW5lcnMiLCJjdXJyZW50VGFyZ2V0IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJ2YWxpZGF0b3IiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfdmFsaWRhdG9yIiwiX3N1Ym1pdEJ1dHRvbiIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1WYWx1ZXMiLCJmb3JFYWNoIiwiaW5wdXQiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwicHJldmVudERlZmF1bHQiLCJzdWJtaXNzaW9uQ29tcGxlYXRlIiwicmVzZXQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIkZvcm1WYWxpZGF0b3IiLCJvcHRpb25zIiwiZm9ybUVsZW1lbnQiLCJfb3B0aW9ucyIsIl9mb3JtRWxlbWVudCIsIl9idXR0b25FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiZm9yY2VIaWRlSW5wdXRFcnJvciIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsImZvcmNlRGlzYWJsZSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImRpc2FibGVkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImZvcm12YWxpZGF0b3JMaXN0IiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2dldFJlcXVlc3QiLCJlbmRQb2ludCIsIm1ldGhvZCIsImZldGNoIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIl9yZXF1ZXN0V2l0aEJvZHkiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFVzZXJEYXRhIiwiZWRpdFByb2ZpbGUiLCJlZGl0QXZhdGFyIiwiZ2V0SW5pdGlhbENhcmRzIiwiYWRkQ2FyZCIsImlzTGlrZSIsImNhcmRJZCIsInJlbW92ZUNhcmQiLCJhdXRob3JpemF0aW9uIiwiZ2FsbGVyeVNlY3Rpb24iLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2VsZW1lbnRzQ29udGFpbmVyIiwic2V0SXRlbXMiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicHJlcGVuZCIsImFwcGVuZENoaWxkIiwiY3JlYXRlQ2FyZCIsImZvcm0iLCJpZCIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lTGFiZWwiLCJfam9iTGFiZWwiLCJfYXZhdGFyU1JDIiwiZ2V0VXNlckluZm8iLCJqb2IiLCJpbWciLCJzZXRVc2VySW5mbyIsInNldEF2YXRhckxpbmsiLCJwcm9maWxlTW9kYWwiLCJmb3JtRGF0YSIsImFib3V0IiwicmVzcG9uY2UiLCJmaW5hbGx5IiwiY2FyZHNNb2RhbCIsInRpdGxlIiwicmVzcG9uc2UiLCJhdmFyRWRpdE1vZGFsIiwiYXZhdGFyIiwiaW1hZ2VNb2RhbCIsIl9pbWFnZSIsIl9pbWFnZUxhYmVsIiwicHJlRGVsZXRlcG91cCIsIl9idXR0b24iLCJfY2FyZCIsImhhbmRsZXJSZW1vdmVDYXJkIiwiaW5pdGlhbENhcmRzIl0sInNvdXJjZVJvb3QiOiIifQ==